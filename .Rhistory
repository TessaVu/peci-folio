popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_CBM, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Climate Burden EJI"
) %>%
# Health vulnerability.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", RPL_HVM)(RPL_HVM),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_HVM, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Health Vulnerability EJI"
) %>%
# Overall EJI.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("mako", RPL_EJI_CBM)(RPL_EJI_CBM),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_EJI_CBM, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Overall EJI"
) %>%
# Add legends for each layer.
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$pop_density),
values = map_tracts$pop_density,
title = "Population<br>Density",
opacity = 0.75,
group = "Population Density"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$med_h_inc),
values = map_tracts$med_h_inc,
title = "Median<br>Income (Quantile)",
opacity = 0.75,
labFormat = labelFormat(big.mark = ","),
group = "Median Household Income"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$RPL_EBM),
values = map_tracts$RPL_EBM,
title = "Environmental Burden EJI",
opacity = 0.75,
group = "Environmental Burden EJI"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$RPL_CBM),
values = map_tracts$RPL_CBM,
title = "Climate Burden EJI",
opacity = 0.75,
group = "Climate Burden EJI"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$RPL_HVM,),
values = map_tracts$RPL_HVM,
title = "Health Vulnerability EJI",
opacity = 0.75,
group = "Health Vulnerability EJI"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("mako", map_tracts$RPL_EJI_CBM),
values = map_tracts$RPL_EJI_CBM,
title = "Overall EJI",
opacity = 0.75,
group = "Overall EJI"
) %>%
addLayersControl(
overlayGroups = c("Population Density", "Median Household Income", "Environmental Burden EJI", "Climate Burden EJI", "Health Vulnerability EJI", "Overall EJI"),
options = layersControlOptions(collapsed = TRUE)
) %>%
hideGroup(c("Population Density", "Median Household Income", "Environmental Burden EJI", "Climate Burden EJI", "Health Vulnerability EJI"))
#| echo: false
#| fig-height: 10
#| fig-width: 12
# Leaflet mapping.
# Base layer.
ej_map <- leaflet(map_tracts) %>%
addTiles() %>%
setView(lng = -75.1638, lat = 39.9523, zoom = 11) %>%
# Population density.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", pop_density)(pop_density),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Population Density (sq. mi.): ", format(pop_density, big.mark = ",", digits = 2, nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Population Density"
) %>%
# Median income.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", med_h_inc)(med_h_inc),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Population Density (sq. mi.): ", format(pop_density, big.mark = ",", digits = 2, nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Median Household Income"
) %>%
# Environmental burden.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", RPL_EBM)(RPL_EBM),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_EBM, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Environmental Burden EJI"
) %>%
# Climate burden.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", RPL_CBM)(RPL_CBM),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_CBM, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Climate Burden EJI"
) %>%
# Health vulnerability.
addPolygons(
data = map_tracts,
fillColor = ~colorNumeric("viridis", RPL_HVM)(RPL_HVM),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_HVM, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Health Vulnerability EJI"
) %>%
# Overall EJI.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("mako", RPL_EJI_CBM)(RPL_EJI_CBM),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_EJI_CBM, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Overall EJI"
) %>%
# Add legends for each layer.
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$pop_density),
values = map_tracts$pop_density,
title = "Population<br>Density",
opacity = 0.75,
group = "Population Density"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$med_h_inc),
values = map_tracts$med_h_inc,
title = "Median<br>Income (Quantile)",
opacity = 0.75,
labFormat = labelFormat(big.mark = ","),
group = "Median Household Income"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$RPL_EBM),
values = map_tracts$RPL_EBM,
title = "Environmental Burden EJI",
opacity = 0.75,
group = "Environmental Burden EJI"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$RPL_CBM),
values = map_tracts$RPL_CBM,
title = "Climate Burden EJI",
opacity = 0.75,
group = "Climate Burden EJI"
) %>%
addLegend(
position = "bottomright",
pal = colorNumeric("viridis", map_tracts$RPL_HVM,),
values = map_tracts$RPL_HVM,
title = "Health Vulnerability EJI",
opacity = 0.75,
group = "Health Vulnerability EJI"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("mako", map_tracts$RPL_EJI_CBM),
values = map_tracts$RPL_EJI_CBM,
title = "Overall EJI",
opacity = 0.75,
group = "Overall EJI"
) %>%
addLayersControl(
overlayGroups = c("Population Density", "Median Household Income", "Environmental Burden EJI", "Climate Burden EJI", "Health Vulnerability EJI", "Overall EJI"),
options = layersControlOptions(collapsed = TRUE)
) %>%
hideGroup(c("Population Density", "Median Household Income", "Environmental Burden EJI", "Climate Burden EJI", "Health Vulnerability EJI"))
ej_map
#| echo: false
#| fig-height: 10
#| fig-width: 12
# Leaflet mapping.
# Base layer.
ej_map <- leaflet(map_tracts) %>%
addTiles() %>%
setView(lng = -75.1638, lat = 39.9523, zoom = 11) %>%
# Population density.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", pop_density)(pop_density),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Population Density (sq. mi.): ", format(pop_density, big.mark = ",", digits = 2, nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Population Density"
) %>%
# Median income.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", med_h_inc)(med_h_inc),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Population Density (sq. mi.): ", format(pop_density, big.mark = ",", digits = 2, nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Median Household Income"
) %>%
# Environmental burden.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", RPL_EBM)(RPL_EBM),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_EBM, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Environmental Burden EJI"
) %>%
# Climate burden.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", RPL_CBM)(RPL_CBM),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_CBM, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Climate Burden EJI"
) %>%
# Health vulnerability.
addPolygons(
data = map_tracts,
fillColor = ~colorNumeric("viridis", RPL_HVM)(RPL_HVM),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_HVM, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Health Vulnerability EJI"
) %>%
# Overall EJI.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", RPL_EJI_CBM)(RPL_EJI_CBM),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_EJI_CBM, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Overall EJI"
) %>%
# Add legends for each layer.
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$pop_density),
values = map_tracts$pop_density,
title = "Population<br>Density",
opacity = 0.75,
group = "Population Density"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$med_h_inc),
values = map_tracts$med_h_inc,
title = "Median<br>Income (Quantile)",
opacity = 0.75,
labFormat = labelFormat(big.mark = ","),
group = "Median Household Income"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$RPL_EBM),
values = map_tracts$RPL_EBM,
title = "Environmental Burden EJI",
opacity = 0.75,
group = "Environmental Burden EJI"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$RPL_CBM),
values = map_tracts$RPL_CBM,
title = "Climate Burden EJI",
opacity = 0.75,
group = "Climate Burden EJI"
) %>%
addLegend(
position = "bottomright",
pal = colorNumeric("viridis", map_tracts$RPL_HVM,),
values = map_tracts$RPL_HVM,
title = "Health Vulnerability EJI",
opacity = 0.75,
group = "Health Vulnerability EJI"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$RPL_EJI_CBM),
values = map_tracts$RPL_EJI_CBM,
title = "Overall EJI",
opacity = 0.75,
group = "Overall EJI"
) %>%
addLayersControl(
overlayGroups = c("Population Density", "Median Household Income", "Environmental Burden EJI", "Climate Burden EJI", "Health Vulnerability EJI", "Overall EJI"),
options = layersControlOptions(collapsed = TRUE)
) %>%
hideGroup(c("Population Density", "Median Household Income", "Environmental Burden EJI", "Climate Burden EJI", "Health Vulnerability EJI"))
ej_map
