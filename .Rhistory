color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Population Density (sq. mi.): ", format(pop_density, big.mark = ",", digits = 2, nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Population Density"
) %>%
# Median income.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", med_h_inc)(med_h_inc),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Population Density (sq. mi.): ", format(pop_density, big.mark = ",", digits = 2, nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Median Household Income"
) %>%
# Socioeconomic SVI.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", RPL_theme1)(RPL_theme1),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_theme1, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Socioeconomic Status SVI"
) %>%
# Household SVI.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", RPL_theme2)(RPL_theme2),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_theme2, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Household Characteristics SVI"
) %>%
# Racial and ethnic minority SVI.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", RPL_theme3)(RPL_theme3),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_theme3, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Racial & Ethnic Minority Status SVI"
) %>%
# Housing type and transportation SVI.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", RPL_theme4)(RPL_theme4),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_theme4, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Housing Type & Transportation SVI"
) %>%
# Overall SVI.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", RPL_themes)(RPL_themes),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_themes, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Overall SVI"
) %>%
# MP POIs
addCircleMarkers(
data = MP_POI,
radius = 3,
color = "black",
fillColor = "black",
fillOpacity = 1,
opacity = 1,
label = ~paste0(
"<strong>", Name, "</strong><br>",
Description
) %>% lapply(htmltools::HTML),
labelOptions = labelOptions(
style = list("font-weight" = "normal", "padding" = "3px 8px"),
textsize = "12px",
direction = "auto"
),
popup = ~paste0(
"<strong>", Name, "</strong><br>",
Description
),
group = "MP Points of Interest",
options = pathOptions(pane = "markerPane")
) %>%
# PFAS POIs
addCircleMarkers(
data = PFAS_POI,
radius = 3,
color = "red",
fillColor = "red",
fillOpacity = 1,
opacity = 1,
label = ~paste0(
"<strong>", Name, "</strong><br>",
Description
) %>% lapply(htmltools::HTML),
labelOptions = labelOptions(
style = list("font-weight" = "normal", "padding" = "3px 8px"),
textsize = "12px",
direction = "auto"
),
popup = ~paste0(
"<strong>", Name, "</strong><br>",
Description
),
group = "PFAS Points of Interest",
options = pathOptions(pane = "markerPane")
) %>%
# Add legends for each layer.
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$pop_density),
values = map_tracts$pop_density,
title = "Population<br>Density",
opacity = 0.75,
group = "Population Density"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$med_h_inc),
values = map_tracts$med_h_inc,
title = "Median<br>Income (Quantile)",
opacity = 0.75,
labFormat = labelFormat(big.mark = ","),
group = "Median Household Income"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$RPL_theme1),
values = map_tracts$RPL_theme1,
title = "Socioeconomic Status SVI",
opacity = 0.75,
group = "Socioeconomic Status SVI"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$RPL_theme2),
values = map_tracts$RPL_theme2,
title = "Household Characteristics SVI",
opacity = 0.75,
group = "Household Characteristics SVI"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$RPL_theme3),
values = map_tracts$RPL_theme3,
title = "Racial & Ethnic Minority Status SVI",
opacity = 0.75,
group = "Racial & Ethnic Minority Status SVI"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$RPL_theme4),
values = map_tracts$RPL_theme4,
title = "Housing Type & Transportation SVI",
opacity = 0.75,
group = "Housing Type & Transportation SVI"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$RPL_themes),
values = map_tracts$RPL_themes,
title = "Overall SVI",
opacity = 0.75,
group = "Overall SVI"
) %>%
addLayersControl(
overlayGroups = c("Population Density", "Median Household Income", "Socioeconomic Status SVI", "Household Characteristics SVI", "Racial & Ethnic Minority Status SVI", "Racial & Ethnic Minority Status SVI", "Housing Type & Transportation SVI", "Overall SVI", "PFAS Points of Interest", "MP Points of Interest"),
options = layersControlOptions(collapsed = TRUE)
) %>%
hideGroup(c("Population Density", "Median Household Income", "Socioeconomic Status SVI", "Household Characteristics SVI", "Racial & Ethnic Minority Status SVI", "Racial & Ethnic Minority Status SVI", "Housing Type & Transportation SVI"))
svi_map
#| echo: false
#| fig-height: 10
#| fig-width: 12
# Leaflet mapping.
# Base layer.
ej_map <- leaflet(map_tracts) %>%
addTiles() %>%
setView(lng = -75.1638, lat = 39.9523, zoom = 11) %>%
# Population density.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", pop_density)(pop_density),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Population Density (sq. mi.): ", format(pop_density, big.mark = ",", digits = 2, nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Population Density"
) %>%
# Median income.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", med_h_inc)(med_h_inc),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Population Density (sq. mi.): ", format(pop_density, big.mark = ",", digits = 2, nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Median Household Income"
) %>%
# Environmental burden.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", RPL_EBM)(RPL_EBM),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_EBM, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Environmental Burden EJI"
) %>%
# Climate burden.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", RPL_CBM)(RPL_CBM),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_CBM, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Climate Burden EJI"
) %>%
# Health vulnerability.
addPolygons(
data = map_tracts,
fillColor = ~colorNumeric("viridis", RPL_HVM)(RPL_HVM),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_HVM, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Health Vulnerability EJI"
) %>%
# Overall EJI.
addPolygons(
data = map_tracts,
fillColor = ~colorQuantile("viridis", RPL_EJI_CBM)(RPL_EJI_CBM),
weight = 1,
opacity = 1,
color = "white",
dashArray = "3",
fillOpacity = 0.5,
highlightOptions = highlightOptions(
weight = 2,
color = "black",
dashArray = "",
fillOpacity = 0.5,
bringToFront = TRUE
),
popup = ~paste0(
"Tract: ", NAME, "<br>",
"Value: ", format(round(RPL_EJI_CBM, 2), nsmall = 2), "<br>",
"Median Income: $", format(med_h_inc, big.mark = ",", nsmall = 0)
),
group = "Overall EJI"
) %>%
# MP POIs
addCircleMarkers(
data = MP_POI,
radius = 3,
color = "black",
fillColor = "black",
fillOpacity = 1,
opacity = 1,
label = ~paste0(
"<strong>", Name, "</strong><br>",
Description
) %>% lapply(htmltools::HTML),
labelOptions = labelOptions(
style = list("font-weight" = "normal", "padding" = "3px 8px"),
textsize = "12px",
direction = "auto"
),
popup = ~paste0(
"<strong>", Name, "</strong><br>",
Description
),
group = "MP Points of Interest",
options = pathOptions(pane = "markerPane")
) %>%
# PFAS POIs
addCircleMarkers(
data = PFAS_POI,
radius = 3,
color = "red",
fillColor = "red",
fillOpacity = 1,
opacity = 1,
label = ~paste0(
"<strong>", Name, "</strong><br>",
Description
) %>% lapply(htmltools::HTML),
labelOptions = labelOptions(
style = list("font-weight" = "normal", "padding" = "3px 8px"),
textsize = "12px",
direction = "auto"
),
popup = ~paste0(
"<strong>", Name, "</strong><br>",
Description
),
group = "PFAS Points of Interest",
options = pathOptions(pane = "markerPane")
) %>%
# Add legends for each layer.
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$pop_density),
values = map_tracts$pop_density,
title = "Population<br>Density",
opacity = 0.75,
group = "Population Density"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$med_h_inc),
values = map_tracts$med_h_inc,
title = "Median<br>Income (Quantile)",
opacity = 0.75,
labFormat = labelFormat(big.mark = ","),
group = "Median Household Income"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$RPL_EBM),
values = map_tracts$RPL_EBM,
title = "Environmental Burden EJI",
opacity = 0.75,
group = "Environmental Burden EJI"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$RPL_CBM),
values = map_tracts$RPL_CBM,
title = "Climate Burden EJI",
opacity = 0.75,
group = "Climate Burden EJI"
) %>%
addLegend(
position = "bottomright",
pal = colorNumeric("viridis", map_tracts$RPL_HVM,),
values = map_tracts$RPL_HVM,
title = "Health Vulnerability EJI",
opacity = 0.75,
group = "Health Vulnerability EJI"
) %>%
addLegend(
position = "bottomright",
pal = colorQuantile("viridis", map_tracts$RPL_EJI_CBM),
values = map_tracts$RPL_EJI_CBM,
title = "Overall EJI",
opacity = 0.75,
group = "Overall EJI"
) %>%
addLayersControl(
overlayGroups = c("Population Density", "Median Household Income", "Environmental Burden EJI", "Climate Burden EJI", "Health Vulnerability EJI", "Overall EJI", "PFAS Points of Interest", "MP Points of Interest"),
options = layersControlOptions(collapsed = TRUE)
) %>%
hideGroup(c("Population Density", "Median Household Income", "Environmental Burden EJI", "Climate Burden EJI", "Health Vulnerability EJI"))
ej_map
